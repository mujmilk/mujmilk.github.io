{"title":"Google Form Submission Check(下書)","slug":"Google-Form-Submission-Check","date":"2021-06-05T10:11:15.000Z","updated":"2021-06-05T10:11:15.000Z","comments":true,"path":"api/articles/Google-Form-Submission-Check.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<h1 id=\"Google-Form-Submission-Checkを作成したときのメモ\"><a href=\"#Google-Form-Submission-Checkを作成したときのメモ\" class=\"headerlink\" title=\"Google Form Submission Checkを作成したときのメモ\"></a><a href=\"https://github.com/mujmilk/google-form-submission-check\">Google Form Submission Check</a>を作成したときのメモ</h1><p>【この記事は作成途中です】</p>\n<h2 id=\"ファイル名一覧を取得\"><a href=\"#ファイル名一覧を取得\" class=\"headerlink\" title=\"ファイル名一覧を取得\"></a>ファイル名一覧を取得</h2><p>スプレッドシートを新規作成＞スクリプトエディタ<br><a href=\"https://qiita.com/akiko-pusu/items/43c89dcfeb1d544cce38\">https://qiita.com/akiko-pusu/items/43c89dcfeb1d544cce38</a><br>フォルダのidは<a href=\"https://drive.google.com/drive/u/3/folders/xxx%E3%81%AExxx\">https://drive.google.com/drive/u/3/folders/xxxのxxx</a><br>getSheetByName(sheetName)をSpreadsheetApp.getActiveSheet()に変更<br>ss&#x3D;getActiveを削除<br>sheetNameの行を削除<br>このエラーでつまった：<a href=\"https://note.com/yogox/n/nec670c8866e7\">https://note.com/yogox/n/nec670c8866e7</a><br>（getActiveSheetとgetActiveSpreadSheetの違いに注意:スプレッドシートの中に複数シートがある：<a href=\"https://memodays.jp/584/#toc3%EF%BC%89\">https://memodays.jp/584/#toc3）</a><br>ひとまずフォルダ一覧を書き出すことに成功</p>\n<ul>\n<li>ファイル名一覧から名前を探す</li>\n<li>書式を揃える-&gt;名前でソート</li>\n<li>今回の要件を満たした名前を抽出</li>\n<li>その名前のところに〇を書き込んだシートを出力<br>スプレッドシートの読み込み<a href=\"https://auto-worker.com/blog/?p=640\">https://auto-worker.com/blog/?p=640</a><br>連想配列にはlength型がない<a href=\"https://rabbitfoot.xyz/gas-associativearray/\">https://rabbitfoot.xyz/gas-associativearray/</a><br>連想配列の連想配列も作れる<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hoge = &#123;&#125;;</span><br><span class=\"line\">hoge[&quot;key&quot;] = &#123;&quot;key2&quot;:value&#125;;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p>文字列の切り出しにはsplit<br><code>let text = &quot;hoge - fuga.txt&quot;</code>　からfugaを切り出す</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let splitText = text.split(&quot; - &quot;);</span><br><span class=\"line\">let splitText2 = splitText[1].split(&quot;.txt&quot;);</span><br><span class=\"line\">Logger.log(splitText2[0]);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt; fuga</span><br></pre></td></tr></table></figure>\n\n<p>forEachが使える <a href=\"https://qiita.com/wifeofvillon/items/15359535a834832e08ea\">https://qiita.com/wifeofvillon/items/15359535a834832e08ea</a></p>\n<p>連想配列のキーの存在有無<br><code>a in hoge</code> や <code>a[hoge]:undefined</code> は使えなかった</p>\n<p>日付の取得<br><a href=\"https://for-dummies.net/gas-noobs/how-to-get-updated-date-of-folders-and-files-on-google-drive/\">https://for-dummies.net/gas-noobs/how-to-get-updated-date-of-folders-and-files-on-google-drive/</a><br><code>parseInt()</code>か<code>Number()</code> で文字列→数値に変換<br>比較して締め切り前に更新されたファイルのみ取得<br>年をまたぐと比較不可に，その他にも色々バグがあった<br>→Date型を生成して直接比較演算子(＞,＜)が使える！<br>buff.getLastUpdated(); で返ってくるのはDate型</p>\n","categories":[],"tags":[]}