{"title":"minecraft-server-1.18.1","slug":"minecraft-server-1-18-1","date":"2022-01-12T10:13:10.000Z","updated":"2022-01-12T10:13:10.000Z","comments":true,"path":"api/articles/minecraft-server-1-18-1.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<h1 id=\"Minecraft-サーバ構築方法-amp-配布ワールドの導入\"><a href=\"#Minecraft-サーバ構築方法-amp-配布ワールドの導入\" class=\"headerlink\" title=\"Minecraft サーバ構築方法 &amp; 配布ワールドの導入\"></a>Minecraft サーバ構築方法 &amp; 配布ワールドの導入</h1><h2 id=\"環境\"><a href=\"#環境\" class=\"headerlink\" title=\"環境\"></a>環境</h2><p>Minecraft 1.18.1<br>CentOS 7.2 (7.2よりも新しいバージョンだとscreenが入らなかった)  </p>\n<h2 id=\"概要\"><a href=\"#概要\" class=\"headerlink\" title=\"概要\"></a>概要</h2><p><a href=\"https://minecraft.server-memo.net/conoha_mc_install/\">【CentOS 7】ConoHaのVPSでマイクラマルチサーバを構築 | minecraft.server-memo.net</a>を参考にMinecraftマルチ用サーバを構築したときのメモ</p>\n<h2 id=\"目次\"><a href=\"#目次\" class=\"headerlink\" title=\"目次\"></a>目次</h2><p>１．構築手順<br>２．配布ワールドの導入方法  </p>\n<hr>\n<h2 id=\"１．構築手順\"><a href=\"#１．構築手順\" class=\"headerlink\" title=\"１．構築手順\"></a>１．構築手順</h2><ol>\n<li><p>サーバに接続する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@IPアドレス</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>アップデートしてからサーバを再起動する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y update</span><br><span class=\"line\">reboot</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>サーバに再接続する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@IPアドレス</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Minecraftをプレイするユーザ用のアカウントを追加する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser minecraft</span><br><span class=\"line\">passwd minecraft</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"必要なパッケージをインストールする\"><a href=\"#必要なパッケージをインストールする\" class=\"headerlink\" title=\"必要なパッケージをインストールする\"></a>必要なパッケージをインストールする</h3><ol start=\"5\">\n<li>Javaをインストールする<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install java-17-openjdk java-17-openjdk-devel</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>Minecraft 1.17.1 ならJava16を入れるらしい．</li>\n<li>(更新2023&#x2F;10&#x2F;14)上記コマンドで入らない場合: 以下のコマンドを代わりに実行する(参考: <a href=\"https://it-jog.com/java/intro/install-openjdk-oncentos7\">OpenJDKをインストールする【CentOS7】</a>)<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/adoptium.repo</span><br><span class=\"line\">[Adoptium]</span><br><span class=\"line\">name=Adoptium</span><br><span class=\"line\">baseurl=https://packages.adoptium.net/artifactory/rpm/$&#123;DISTRIBUTION_NAME:-$(. /etc/os-release; echo $ID)&#125;/\\$releasever/\\$basearch</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=https://packages.adoptium.net/artifactory/api/gpg/key/public</span><br><span class=\"line\">EOF</span><br><span class=\"line\"></span><br><span class=\"line\">yum -y install temurin-17-jdk</span><br></pre></td></tr></table></figure></li>\n</ul>\n<ol start=\"6\">\n<li>screenをインストールする<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install screen</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"ポートの設定をする\"><a href=\"#ポートの設定をする\" class=\"headerlink\" title=\"ポートの設定をする\"></a>ポートの設定をする</h3><p><a href=\"https://minecraft.server-memo.net/conoha_mc_install/\">【CentOS 7】ConoHaのVPSでマイクラマルチサーバを構築 | minecraft.server-memo.net</a> の SSH設定，ファイアウォール設定 のところを実行する</p>\n<details>\n<summary>詳細手順(クリックで開きます)</summary>\n<div>\n\n<ol>\n<li>sshd_configを開いてsshで使用するポート番号を編集し，rootでssh接続することを禁止する．<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config_20220112</span><br><span class=\"line\">vi /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>sshd_configが開いたら，PermitRootLoginをno，Port 22をPort 12222に変更する</li>\n</ul>\n<ol start=\"2\">\n<li><p>sshdを再起動する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart sshd</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ファイアウォールの設定を行う．12222番(ssh用)，25565番(ゲームプレイ用)ポートを開き，元からあるsshのポートを閉じる</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --add-port=12222/tcp</span><br><span class=\"line\">firewall-cmd --permanent --remove-service=ssh</span><br><span class=\"line\">firewall-cmd --permanent --add-port=25565/tcp</span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n</div>\n</details></li>\n</ol>\n<h4 id=\"ここまで設定できたら\"><a href=\"#ここまで設定できたら\" class=\"headerlink\" title=\"ここまで設定できたら\"></a>ここまで設定できたら</h4><ul>\n<li>次回サーバにログインするときは <code>ssh -p 12222 minecraft@IPアドレス</code> のように，<code>-p</code>オプションをつけてポート番号を指定する．(何も付けなければ自動的に22番でアクセスを試みる)</li>\n<li>Minecraftをプレイするときは，マルチプレイの設定画面でサーバアドレスを<code>IPアドレス:25565</code>のようにする</li>\n<li>(conohaVPSを使っている場合)この設定を行った後サーバの管理画面orレンタル画面でポート番号のアクセス許可設定をいじるとうまくアクセスできなくなるので注意</li>\n</ul>\n<h3 id=\"Minecraftのサーバをインストールする\"><a href=\"#Minecraftのサーバをインストールする\" class=\"headerlink\" title=\"Minecraftのサーバをインストールする\"></a>Minecraftのサーバをインストールする</h3><ol>\n<li><p>サーバをインストールするディレクトリを作成する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /opt/minecraft</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ディレクトリの所有者を先程作成したMinecraftユーザ用のアカウントに設定する <strong>(重要)</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chown minecraft:minecraft /opt/minecraft</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>rootが所有者になっているファイルにMinecraftをプレイするユーザはアクセスできない．<br>  うまく配布ワールド等が導入できない場合は，所有者の設定をミスっているのが原因かも?</li>\n</ul>\n<ol start=\"3\">\n<li>Minecraftをプレイするユーザ用のアカウントに切り替え，必要なファイルをダウンロードする<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su - minecraft</span><br><span class=\"line\">cd /opt/minecraft</span><br><span class=\"line\">wget https://launcher.mojang.com/v1/objects/125e5adf40c659fd3bce3e66e67a16bb49ecc1b9/server.jar</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>↑は2022&#x2F;01&#x2F;12時点のリンク．切れていたら <a href=\"https://www.minecraft.net/ja-jp/download/server\">https://www.minecraft.net/ja-jp/download/server</a> で確認(<code>minecraft_server.1.18.1.jar</code>を右クリック-&gt;リンクをコピー)</li>\n</ul>\n<ol start=\"4\">\n<li>ファイルをバックアップ，サーバを起動<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp server.jar minecraft_server.jar</span><br><span class=\"line\">mv server.jar minecraft_server_1.18.1.jar</span><br><span class=\"line\">java -Xms1024M -Xmx1024M -jar minecraft_server.jar nogui</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>設定ファイルが生成された後，停止する</li>\n</ul>\n<ol start=\"5\">\n<li><p>↑の実行が終わったら，生成されたeula.txtを開き，<code>eula=false</code>の行を<code>eula=true</code>に変更する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi eula.txt</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>再度以下のコマンドを実行すると，正常に起動できるはず</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -Xms1024M -Xmx1024M -jar minecraft_server.jar nogui</span><br></pre></td></tr></table></figure>\n<p>起動中に<code>stop</code>と入力することで停止する</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"その他設定\"><a href=\"#その他設定\" class=\"headerlink\" title=\"その他設定\"></a>その他設定</h3><p>起動スクリプト，自動起動の設定をするなら: <a href=\"https://minecraft.server-memo.net/conoha_mc_install/\">【CentOS 7】ConoHaのVPSでマイクラマルチサーバを構築 | minecraft.server-memo.net</a><br>サーバ側にModを導入する: <a href=\"https://minecraft.server-memo.net/forge_server_install/\">CentOS7にMinecraft Forgeサーバをインストールする方法 | minecraft.server-memo.net</a><br>クライアント側にModを導入する:<br><a href=\"https://support.conoha.jp/v/hellovps-m-04/?btn_id=v-hellovps-m-03-sidebar_v-hellovps-m-04\">Modを導入してMinecraftで遊んでみよう｜ConoHa VPSサポート</a> </p>\n<hr>\n<h3 id=\"２．配布ワールドの導入方法\"><a href=\"#２．配布ワールドの導入方法\" class=\"headerlink\" title=\"２．配布ワールドの導入方法\"></a>２．配布ワールドの導入方法</h3><ol>\n<li><p>server.propertiesを開き，<code>enable-command-block=false</code>の行を<code>enable-command-block=true</code>に変更する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi server.properties</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配布ワールドが入ったZIPファイルをダウンロードする</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget ダウンロードリンク</span><br></pre></td></tr></table></figure></li>\n</ol>\n<ul>\n<li>直でダウンロードできるリンクがわからない場合は，一旦PCにダウンロードしてから<code>scp -P 12222 ZIPファイル名 minecraft@IPアドレス:/opt/minecraft/</code>で転送する</li>\n</ul>\n<ol start=\"3\">\n<li><p>ZIPファイルを解凍し，worldフォルダをバックアップしてから解凍してできたフォルダの名前をworldに変更する</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip ダウンロードしたファイル.zip</span><br><span class=\"line\">mv world original_world</span><br><span class=\"line\">mv 解凍してできたフォルダ名 world</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>再度サーバを起動してゲームにログインすると，配布ワールドが導入できているはず</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -Xms1024M -Xmx1024M -jar minecraft_server.jar nogui</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"コマンドメモ\"><a href=\"#コマンドメモ\" class=\"headerlink\" title=\"コマンドメモ\"></a>コマンドメモ</h3><ul>\n<li><code>/op ユーザ名</code>: ユーザにオペレータ権限を付与する(サーバ側で実行)</li>\n<li><code>/gamemode survival/adventure/creative</code>: ゲームモードを変更する</li>\n<li><code>/difficulty peaceful/easy/normal/hard</code>: 難易度変更</li>\n<li><code>/tp ユーザ名 x座標 y座標 z座標</code>: ユーザをx y zの位置にテレポートさせる(<code>@a</code>で全員，座標に<code>~</code>とすると現在位置が入る 例:<code>/tp @a ~ ~ ~</code>で全員自分のいる場所にワープしてくる)</li>\n<li>参考<ul>\n<li><a href=\"https://minecraft.fandom.com/ja/wiki/%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">コマンド - Minecraft Wiki</a></li>\n<li><a href=\"https://gamepedia.jp/minecraft/archives/11925\">【マイクラJava版】【Java版】チートコマンドの基本を解説！使い方とよく使うコマンド一覧【Minecraft】 – 攻略大百科</a></li>\n</ul>\n</li>\n</ul>\n","categories":[],"tags":[]}